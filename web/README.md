# Aspera transfers in web app using Connect or HTTP Gateway and Node API

This application shows how to start a file transfer in a web browser using either the Aspera Connect SDK or the Aspera HTTP Gateway SDK.

In both case, starting a transfer consists in building a **transfer spec**.

In this example, the transfer spec is build either:

- Using a broker app (server) which in turn calls the HSTS node API (and then uses a token)
- using SSH credentials (demo only, do not do that)

## Configuration

Refer to [the configuration section of the upper README.md](../README.md#configuration-file) to create `../config.yaml`.

This sample app uses these values from the config file (`../config.yaml`):

```yaml
httpgw:
  url: https://mygw.example.com/aspera/http-gwy
node:
    url: https://server.example.com
    user: _node_user_here_
    pass: _node_pass_here_
server:
    url: ssh://eudemo.asperademo.com:33001
    user: _server_user_here_
    pass: _server_pass_here_
    download_file: /aspera-test-dir-small/10MB.1
    upload_folder: /Upload
```

The server part uses the YAML, and the client part uses a JSON file generated by the `Makefile`: `conf.js`.
It can also be generated manually using:

```bash
node script/convert.js ../config.yaml > conf.js
```

## Setup and Run

Install [nodeJS](https://nodejs.org/) (v>=17, with `fetch`).
Check version with:

```bash
node --version
```

Then execute:

```bash
make
```

This will install nodejs packages, generate the JSON config file from YAML and run the express web server.

Alternatively run manually:

```bash
node script/convert.js ../config.yaml > conf.js
node --trace-warnings src/server.js ../config.yaml 3000 .
```

Then open a browser to:

<http://localhost:3000>

## References

[Aspera Connect Sample code](https://github.com/IBM/aspera-connect-sdk-js)

[Aspera Connect API Reference](https://ibm.github.io/aspera-connect-sdk-js/)

[Aspera HTTP GW SDK documentation](https://developer.ibm.com/apis/catalog?search=%22aspera%20http%22)

[Aspera Connect SDK documentation](https://developer.ibm.com/apis/catalog?search=%22aspera%20connect%22)

[All Aspera APIs here](https://developer.ibm.com/apis/catalog?search=aspera)
